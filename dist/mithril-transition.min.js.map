{"version":3,"sources":["mithril-transition.js"],"names":[],"mappings":"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","file":"mithril-transition.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.mithrilTransition = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nconst createHistory = require('./lib/history');\nconst { oncreate, onremove } = require('./lib/hooks');\nconst enabled = Symbol('enabled');\n\nmodule.exports = function createTransition({\n    animation,\n    useHistory = true,\n    persistHistoryAs = null,\n    classList = {\n        parent: 'm-transition-parent',\n        lastElm: 'm-transition-last-element',\n        nextElm: 'm-transition-new-element',\n        direction: 'm-transition-<direction>'\n    },\n    disable = function () {}\n} = {}) {\n\n    if (!animation) {\n        throw new Error('Error in mithril-transition: option [animation] is required.');\n    }\n\n    const that = {\n        useHistory,\n        animation,\n        classList,\n        [enabled]: true,\n        isEnabled() {\n            return that[enabled];\n        },\n        enable() {\n            that[enabled] = true;\n        },\n        disable() {\n            disable();\n            that[enabled] = false;\n        },\n        oncreate(...args) {\n            return oncreate.call(that, ...args);\n        },\n        onremove(...args) {\n            return onremove.call(that, ...args);\n        }\n    };\n\n    if (that.useHistory) {\n        that.history = createHistory(persistHistoryAs);\n    }\n\n    return that;\n};\n\n},{\"./lib/history\":3,\"./lib/hooks\":4}],2:[function(require,module,exports){\nexports.loadClasses = function (classList, lastElm, elem, direction) {\n    elem.parentNode.classList.add(classList.parent);\n    lastElm.classList.add(classList.lastElm);\n    elem.classList.add(classList.nextElm);\n    elem.classList.add(classList.direction.replace('<direction>', direction));\n};\n\nexports.unloadClasses = function (classList, barrier, parentNode, elem, direction) {\n    const newBarrier = barrier - 1;\n\n    if (newBarrier > 0) {\n        return newBarrier;\n    }\n\n    elem.classList.remove(classList.nextElm);\n    elem.classList.remove(classList.direction.replace('<direction>', direction));\n\n    if (elem.parentNode) {\n        elem.parentNode.classList.remove(classList.parent);\n    }\n\n    return newBarrier;\n};\n\n},{}],3:[function(require,module,exports){\nfunction persistHistory(key, stack) {\n    if (key) {\n        sessionStorage.setItem(key, JSON.stringify(stack));\n    }\n}\n\nfunction clearHistory(key) {\n    if (key) {\n        sessionStorage.removeItem(key);\n    }\n}\n\nmodule.exports = function createHistory(persistHistoryAs = null) {\n    let stack = [];\n    if (persistHistoryAs) {\n        if (sessionStorage.getItem(persistHistoryAs)) {\n            stack = JSON.parse(sessionStorage.getItem(persistHistoryAs));\n        }\n    }\n    return {\n        persistHistoryAs,\n        stack,\n        push(key) {\n            this.stack.push(key);\n            persistHistory(this.persistHistoryAs, this.stack);\n        },\n        pop() {\n            this.stack.pop();\n            persistHistory(this.persistHistoryAs, this.stack);\n        },\n        clear() {\n            this.stack = [];\n            clearHistory(this.persistHistoryAs);\n        },\n        last() {\n            return this.stack[this.stack.length - 1] ?\n                this.stack[this.stack.length - 1] :\n                undefined;\n        },\n        direction(key, last) {\n            if (this.last() === key) {\n                // if the page that comes it was in the final of the history queue i pop from that\n                this.pop();\n                return 'prev';\n            } else if (last) {\n                // if direction is go the next i save the state of the last element\n                this.push(last.key);\n            }\n\n            return 'next';\n        }\n    };\n};\n\n\n},{}],4:[function(require,module,exports){\nconst {\n    loadClasses,\n    unloadClasses\n} = require('./classes');\n\nmodule.exports = {\n\n    oncreate(vnode) {\n        const key = vnode.key;\n        const dom = vnode.dom;\n        if (this.useHistory && !key) {\n            throw new Error('Error in mithril-transition: is required specified a key for the vnode if you want to use the history.');\n        }\n\n        if (this.isEnabled()) {\n            const parentNode = dom.parentNode;\n\n            let direction = 'next';\n\n            if (this.useHistory) {\n                direction = this.history.direction(key, this.last);\n            }\n\n            if (this.last) {\n                let lastElm = this.last.dom;\n                const classList = this.classList;\n\n                const id = 'mithril-transition-' + Date.now();\n\n                loadClasses(classList, lastElm, dom, direction);\n\n                lastElm.setAttribute('data-transition-id', id);\n\n                parentNode.insertAdjacentHTML('beforeend', lastElm.outerHTML);\n\n                lastElm = parentNode.querySelector('[data-transition-id=' + id + ']');\n\n                let barrier = 2;\n                this.animation({\n                    lastElm,\n                    nextElm: dom,\n                    direction,\n                    cbLast() {\n                        lastElm.parentNode.removeChild(lastElm);\n                        barrier = unloadClasses(classList, barrier, parentNode, dom, direction);\n                    },\n                    cbNext() {\n                        barrier = unloadClasses(classList, barrier, parentNode, dom, direction);\n                    }\n                });\n            }\n        }\n    },\n\n    onremove(vnode) {\n        if (this.isEnabled()) {\n            // this property block a possible user event during the onunload\n            vnode.dom.style['pointer-events'] = 'none';\n\n            /**\n             *  the current element unloaded\n             *  is going to be the \"new last element\"\n             */\n            this.last = {\n                key: vnode.key,\n                dom: vnode.dom\n            };\n        }\n    }\n\n};\n\n},{\"./classes\":2}]},{},[1])(1)\n});"]}
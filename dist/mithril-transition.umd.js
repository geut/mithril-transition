(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.mithrilTransition=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=transition;function persistHistory(persistHistoryAs,history){if(persistHistoryAs){sessionStorage.setItem(persistHistoryAs,JSON.stringify(history))}}function createHistory(){var persistHistoryAs=arguments.length<=0||arguments[0]===undefined?null:arguments[0];var history=[];if(persistHistoryAs){if(sessionStorage.getItem(persistHistoryAs)){history=JSON.parse(sessionStorage.getItem(persistHistoryAs))}}return{persistHistoryAs:persistHistoryAs,history:history,push:function push(key){this.history.push(key);persistHistory(this.persistHistoryAs,this.history)},pop:function pop(){this.history.pop();persistHistory(this.persistHistoryAs,this.history)},last:function last(){return this.history[this.history.length-1]?this.history[this.history.length-1]:undefined}}}function loadClasses(classList,lastElem,elem,direction){elem.parentNode.classList.add(classList.parent);lastElem.classList.add(classList.lastElem);elem.classList.add(classList.newElem);elem.classList.add(classList.direction.replace("<direction>",direction))}function unloadClasses(classList,barrier,parentNode,elem,direction){var newBarrier=barrier-1;if(newBarrier>0){return newBarrier}elem.classList.remove(classList.newElem);elem.classList.remove(classList.direction.replace("<direction>",direction));if(elem.parentNode){elem.parentNode.classList.remove(classList.parent)}return newBarrier}function config(key,elem,isInit,ctx){var _this=this;if(this.useHistory&&!key){throw new Error("Error in mithril-transition: "+"is required specified a key for the v-node.")}if(!isInit){(function(){var parentNode=elem.parentNode;var direction="next";if(_this.useHistory){if(_this.history.last()===key){direction="prev";_this.history.pop()}else{if(_this.last){_this.history.push(_this.last.key)}}}if(_this.last){(function(){var lastElem=_this.last.elem;var id="mithril-transition-"+Date.now();loadClasses(_this.classList,lastElem,elem,direction);lastElem.dataset.transitionId=id;parentNode.insertAdjacentHTML("beforeend",lastElem.outerHTML);_this.last.elem=lastElem=parentNode.querySelector("[data-transition-id="+id+"]");var barrier=2;_this.anim(lastElem,elem,direction,function(){parentNode.removeChild(lastElem);barrier=unloadClasses(_this.classList,barrier,parentNode,elem,direction)},function(){barrier=unloadClasses(_this.classList,barrier,parentNode,elem,direction)})})()}var userOnUnload=ctx.onunload;ctx.onunload=function(){elem.style["pointer-events"]="none";_this.last={key:key,elem:elem};if(userOnUnload){userOnUnload()}}})()}}function transition(){var _ref=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var anim=_ref.anim;var _ref$useHistory=_ref.useHistory;var useHistory=_ref$useHistory===undefined?true:_ref$useHistory;var _ref$persistHistoryAs=_ref.persistHistoryAs;var persistHistoryAs=_ref$persistHistoryAs===undefined?null:_ref$persistHistoryAs;var _ref$classList=_ref.classList;var classList=_ref$classList===undefined?{parent:"m-transition-parent",lastElem:"m-transition-last-element",newElem:"m-transition-new-element",direction:"m-transition-<direction>"}:_ref$classList;if(!anim){throw new Error("Error in mithril-transition: "+"option `anim` is required.")}var that={useHistory:useHistory,anim:anim,config:config,classList:classList};if(that.useHistory){that.history=createHistory(persistHistoryAs)}return function animate(elem,isInit,ctx){that.config(this.attrs.key,elem,isInit,ctx)}}module.exports=exports["default"]},{}]},{},[1])(1)});
